<view class="container"><view class="header"><view data-event-opts="{{[['tap',[['navBack',['$event']]]]]}}" class="back-button" bindtap="__e"><text class="iconfont icon-left"></text></view><text class="title">{{collegeName?collegeName+'专业管理':'专业管理'}}</text></view><block wx:if="{{!collegeId}}"><view class="filter-bar"><picker value="{{selectedCollegeIndex}}" range="{{collegeNames}}" data-event-opts="{{[['change',[['onCollegeFilterChange',['$event']]]]]}}" bindchange="__e"><view class="picker"><text>{{selectedCollegeIndex>=0?collegeNames[selectedCollegeIndex]:'选择学院'}}</text><text class="iconfont icon-down"></text></view></picker></view></block><view class="action-bar"><button class="add-btn" disabled="{{!selectedCollegeId&&!collegeId}}" data-event-opts="{{[['tap',[['handleAddMajor',['$event']]]]]}}" bindtap="__e">新增专业</button><view class="search-box"><input type="text" placeholder="搜索专业名称" data-event-opts="{{[['input',[['__set_model',['','searchKeyword','$event',[]]]]]]}}" value="{{searchKeyword}}" bindinput="__e"/><text class="iconfont icon-search"></text></view></view><view class="major-list"><block wx:if="{{loading}}"><view class="loading">加载中...</view></block><block wx:else><block wx:if="{{!selectedCollegeId&&!collegeId}}"><view class="empty">请选择学院查看专业</view></block><block wx:else><block wx:if="{{$root.g0===0}}"><view class="empty">该学院暂无专业数据</view></block></block></block><block wx:for="{{filteredMajors}}" wx:for-item="major" wx:for-index="index" wx:key="id"><view class="major-item"><view data-event-opts="{{[['tap',[['navigateToDetail',['$0'],[[['filteredMajors','id',major.id]]]]]]]}}" class="major-info" bindtap="__e"><image class="major-icon" src="{{major.iconUrl||'/static/images/major-icon.png'}}" mode="aspectFit"></image><view class="major-detail"><text class="major-name">{{major.name}}</text><text class="major-meta">{{(major.code||'无专业代码')+" · "+(major.degree||'未设置')+" · "+(major.duration||'未设置')+"年"}}</text></view></view><view class="major-actions"><text data-event-opts="{{[['tap',[['navigateToDetail',['$0'],[[['filteredMajors','id',major.id]]]]]]]}}" class="action-btn edit" bindtap="__e">编辑</text><text data-event-opts="{{[['tap',[['handleDeleteMajor',['$0'],[[['filteredMajors','id',major.id]]]]]]]}}" class="action-btn delete" bindtap="__e">删除</text></view></view></block></view><block wx:if="{{$root.g1>0}}"><view class="pagination"><text class="page-info">{{"共 "+total+" 条"}}</text><view class="page-btns"><button disabled="{{currentPage===1}}" data-event-opts="{{[['tap',[['handlePageChange',[currentPage-1]]]]]}}" bindtap="__e">上一页</button><text class="page-num">{{"第 "+currentPage+" 页"}}</text><button disabled="{{currentPage===totalPages}}" data-event-opts="{{[['tap',[['handlePageChange',[currentPage+1]]]]]}}" bindtap="__e">下一页</button></view></view></block></view>