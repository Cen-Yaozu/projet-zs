<view class="container"><view class="header"><view data-event-opts="{{[['tap',[['navBack',['$event']]]]]}}" class="back-button" bindtap="__e"><text class="iconfont icon-left"></text></view><text class="title">{{isEdit?'编辑专业':'添加专业'}}</text></view><block wx:if="{{loading}}"><view class="loading-overlay"><view class="loading-content"><text class="loading-text">加载中...</text></view></view></block><view class="form-container"><scroll-view class="scroll-view" scroll-y="{{true}}"><view class="form-section"><view class="section-title">基本信息</view><view class="form-item"><text class="label">专业名称<text class="required">*</text></text><input class="input" type="text" placeholder="请输入专业名称" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['majorForm']]]]]}}" value="{{majorForm.name}}" bindinput="__e"/></view><view class="form-item"><text class="label">专业代码</text><input class="input" type="text" placeholder="请输入专业代码" data-event-opts="{{[['input',[['__set_model',['$0','code','$event',[]],['majorForm']]]]]}}" value="{{majorForm.code}}" bindinput="__e"/></view><view class="form-item"><text class="label">所属学院<text class="required">*</text></text><picker value="{{collegeIndex}}" range="{{collegeNames}}" disabled="{{collegeIdFromParams}}" data-event-opts="{{[['change',[['handleCollegeChange',['$event']]]]]}}" bindchange="__e"><view class="picker-value">{{''+(collegeNames[collegeIndex]||'请选择所属学院')+''}}<block wx:if="{{!collegeIdFromParams}}"><text class="iconfont icon-down"></text></block></view></picker></view><view class="form-item"><text class="label">学位类型</text><picker value="{{degreeIndex}}" range="{{degreeOptions}}" data-event-opts="{{[['change',[['handleDegreeChange',['$event']]]]]}}" bindchange="__e"><view class="picker-value">{{''+(degreeOptions[degreeIndex]||'请选择学位类型')+''}}<text class="iconfont icon-down"></text></view></picker></view><view class="form-item"><text class="label">学制(年)</text><picker value="{{durationIndex}}" range="{{durationOptions}}" data-event-opts="{{[['change',[['handleDurationChange',['$event']]]]]}}" bindchange="__e"><view class="picker-value">{{''+(durationOptions[durationIndex]||'请选择学制')+''}}<text class="iconfont icon-down"></text></view></picker></view></view><view class="form-section"><view class="section-title">专业介绍</view><view class="form-item"><text class="label">专业简介</text><textarea class="textarea" placeholder="请输入专业简介" maxlength="1000" data-event-opts="{{[['input',[['__set_model',['$0','description','$event',[]],['majorForm']]]]]}}" value="{{majorForm.description}}" bindinput="__e"></textarea><text class="word-count">{{$root.g0+"/1000"}}</text></view><view class="form-item"><text class="label">培养目标</text><textarea class="textarea" placeholder="请输入培养目标" maxlength="1000" data-event-opts="{{[['input',[['__set_model',['$0','trainingObjectives','$event',[]],['majorForm']]]]]}}" value="{{majorForm.trainingObjectives}}" bindinput="__e"></textarea><text class="word-count">{{$root.g1+"/1000"}}</text></view><view class="form-item"><text class="label">主要课程</text><textarea class="textarea" placeholder="请输入主要课程" maxlength="1000" data-event-opts="{{[['input',[['__set_model',['$0','mainCourses','$event',[]],['majorForm']]]]]}}" value="{{majorForm.mainCourses}}" bindinput="__e"></textarea><text class="word-count">{{$root.g2+"/1000"}}</text></view><view class="form-item"><text class="label">就业前景</text><textarea class="textarea" placeholder="请输入就业前景" maxlength="1000" data-event-opts="{{[['input',[['__set_model',['$0','careerProspects','$event',[]],['majorForm']]]]]}}" value="{{majorForm.careerProspects}}" bindinput="__e"></textarea><text class="word-count">{{$root.g3+"/1000"}}</text></view></view><view class="form-section"><view class="section-title">媒体资源</view><view class="form-item"><text class="label">专业图标</text><view class="upload-area"><block wx:if="{{majorForm.iconUrl}}"><image class="preview-image" src="{{majorForm.iconUrl}}" mode="aspectFit" data-event-opts="{{[['tap',[['previewImage',['$0'],['majorForm.iconUrl']]]]]}}" bindtap="__e"></image></block><block wx:else><view data-event-opts="{{[['tap',[['uploadIcon',['$event']]]]]}}" class="upload-placeholder" bindtap="__e"><text class="iconfont icon-upload"></text><text class="upload-text">上传图标</text></view></block><button data-event-opts="{{[['tap',[['uploadIcon',['$event']]]]]}}" class="upload-btn" bindtap="__e">{{majorForm.iconUrl?'更换':'上传'}}</button></view><text class="hint">推荐尺寸：200x200px，格式：JPG/PNG</text></view><view class="form-item"><text class="label">专业图片集</text><view class="images-list"><block wx:for="{{majorForm.images}}" wx:for-item="image" wx:for-index="index" wx:key="index"><view class="image-item"><image class="preview-image" src="{{image}}" mode="aspectFill" data-event-opts="{{[['tap',[['previewImage',['$0'],[[['majorForm.images','',index]]]]]]]}}" bindtap="__e"></image><text data-event-opts="{{[['tap',[['deleteImage',[index]]]]]}}" class="delete-btn" bindtap="__e">×</text></view></block><block wx:if="{{$root.g4<5}}"><view data-event-opts="{{[['tap',[['uploadImage',['$event']]]]]}}" class="image-item add-image" bindtap="__e"><text class="iconfont icon-add"></text><text class="add-text">添加图片</text></view></block></view><text class="hint">最多添加5张图片，推荐尺寸：1080x720px，格式：JPG/PNG</text></view></view></scroll-view></view><view class="footer"><button data-event-opts="{{[['tap',[['navBack',['$event']]]]]}}" class="cancel-btn" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['submitForm',['$event']]]]]}}" class="submit-btn" bindtap="__e">保存</button></view></view>