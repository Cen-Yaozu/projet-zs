<view class="container"><view class="header"><view data-event-opts="{{[['tap',[['navBack',['$event']]]]]}}" class="back-button" bindtap="__e"><text class="iconfont icon-left"></text></view><text class="title">公告管理</text></view><view class="content"><view class="filter-bar"><view class="search-box"><text class="iconfont icon-search"></text><input class="input" type="text" placeholder="搜索公告标题" data-event-opts="{{[['input',[['__set_model',['','searchKeyword','$event',[]]]]]]}}" value="{{searchKeyword}}" bindinput="__e"/><block wx:if="{{searchKeyword}}"><text data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="clear-icon iconfont icon-close" bindtap="__e"></text></block></view><button data-event-opts="{{[['tap',[['showAddModal',['$event']]]]]}}" class="add-button" bindtap="__e"><text class="add-icon iconfont icon-add"></text><text>新增公告</text></button></view><view class="announcement-list"><block wx:if="{{$root.g0}}"><view class="empty-tip"><text class="empty-icon iconfont icon-empty"></text><view>暂无公告数据</view></view></block><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="__i0__" wx:key="id"><view class="announcement-item"><view class="announce-info"><view class="announce-header"><view class="title">{{item.$orig.title}}</view><view class="{{['status-tag',item.$orig.status?'active':'inactive']}}">{{''+(item.$orig.status?'已发布':'草稿')+''}}</view></view><view class="announce-meta"><view class="meta-item"><text class="meta-icon iconfont icon-time"></text><text>{{item.m0}}</text></view><view class="meta-item"><text class="meta-icon iconfont icon-type"></text><text>{{item.m1}}</text></view></view><block wx:if="{{item.$orig.content}}"><view class="announce-content">{{item.$orig.content}}</view></block></view><view class="action-row"><button data-event-opts="{{[['tap',[['handleEdit',['$0'],[[['announcements','id',item.$orig.id]]]]]]]}}" class="action-button edit-btn" bindtap="__e">编辑</button><block wx:if="{{!item.$orig.status}}"><button data-event-opts="{{[['tap',[['handlePublish',['$0'],[[['announcements','id',item.$orig.id]]]]]]]}}" class="action-button publish-btn" bindtap="__e">发布</button></block><block wx:else><button data-event-opts="{{[['tap',[['handleUnpublish',['$0'],[[['announcements','id',item.$orig.id]]]]]]]}}" class="action-button unpublish-btn" bindtap="__e">撤回</button></block><button data-event-opts="{{[['tap',[['handleDelete',['$0'],[[['announcements','id',item.$orig.id]]]]]]]}}" class="action-button delete-btn" bindtap="__e">删除</button></view></view></block></view><block wx:if="{{$root.g1>0}}"><view class="pagination"><button data-event-opts="{{[['tap',[['handlePageChange',[currentPage-1]]]]]}}" class="{{['page-btn','prev-btn',(currentPage===1)?'disabled':'']}}" bindtap="__e">上一页</button><block wx:for="{{$root.l1}}" wx:for-item="page" wx:for-index="__i1__" wx:key="*this"><button data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" data-event-params="{{({page})}}" class="{{['page-btn',(page===currentPage)?'active':'']}}" bindtap="__e">{{page}}</button></block><button data-event-opts="{{[['tap',[['handlePageChange',[currentPage+1]]]]]}}" class="{{['page-btn','next-btn',(currentPage===totalPages)?'disabled':'']}}" bindtap="__e">下一页</button><text class="page-text">{{"共 "+total+" 条"}}</text></view></block></view><block wx:if="{{loading}}"><view class="loading-overlay"><view class="loading-content"><text class="loading-text">加载中...</text></view></view></block></view>