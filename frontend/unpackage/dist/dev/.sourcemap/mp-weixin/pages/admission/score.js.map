{"version":3,"sources":["uni-app:///main.js","webpack:////Users/macmima1234/Desktop/projet-zs/frontend/pages/admission/score.vue?371e","webpack:////Users/macmima1234/Desktop/projet-zs/frontend/pages/admission/score.vue?9f81","webpack:////Users/macmima1234/Desktop/projet-zs/frontend/pages/admission/score.vue?eb78","webpack:////Users/macmima1234/Desktop/projet-zs/frontend/pages/admission/score.vue?62b4","uni-app:///pages/admission/score.vue","webpack:////Users/macmima1234/Desktop/projet-zs/frontend/pages/admission/score.vue?1209","webpack:////Users/macmima1234/Desktop/projet-zs/frontend/pages/admission/score.vue?08c3"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","years","currentYear","scoreData","processedData","loading","displayMode","showYearSelect","tableData","majorMap","loadingText","contentdown","contentrefresh","contentnomore","onLoad","methods","initData","console","uni","title","icon","fetchMajorMap","request","res","map","ensureDataSource","admissionApi","scores","fetchYears","availableYears","loadScoreData","year","cacheKey","item","majorName","updateTableData","category","province","toggleDisplayMode","openYearPopup","closeYearPopup","selectYear","getMajorNameById"],"mappings":"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","file":"pages/admission/score.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/admission/score.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./score.vue?vue&type=template&id=b7a618ba&\"\nvar renderjs\nimport script from \"./score.vue?vue&type=script&lang=js&\"\nexport * from \"./score.vue?vue&type=script&lang=js&\"\nimport style0 from \"./score.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/admission/score.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./score.vue?vue&type=template&id=b7a618ba&\"","var components\ntry {\n  components = {\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n    uniLoadMore: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-load-more/components/uni-load-more/uni-load-more\" */ \"@/uni_modules/uni-load-more/components/uni-load-more/uni-load-more.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = !!_vm.currentYear && !_vm.loading ? _vm.processedData.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./score.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./score.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"container\">\n    <!-- 顶部导航栏 -->\n    <view class=\"header\">\n      <text class=\"title\">广州航海学院历年分数</text>\n    </view>\n    \n    <!-- 年份和模式选择器 -->\n    <view class=\"filter-bar\">\n      <view class=\"year-selector\" @tap=\"openYearPopup\">\n        <uni-icons type=\"calendar\" size=\"20\" color=\"#0f3c88\"></uni-icons>\n        <text class=\"year-text\">{{ currentYear || '选择年份' }}</text>\n      </view>\n      \n      <view class=\"display-mode\" @tap=\"toggleDisplayMode\">\n        <uni-icons :type=\"displayMode === 'card' ? 'list' : 'grid'\" size=\"20\" color=\"#f89d35\"></uni-icons>\n        <text class=\"mode-text\">{{ displayMode === 'card' ? '表格式' : '卡片式' }}</text>\n      </view>\n    </view>\n    \n    <!-- 指引提示 -->\n    <view v-if=\"!currentYear\" class=\"guide-tips\">\n      <text>请选择年份查看分数数据</text>\n    </view>\n    \n    <!-- 加载中提示 -->\n    <view v-else-if=\"loading\" class=\"loading\">\n      <uni-load-more status=\"loading\" :content-text=\"loadingText\"></uni-load-more>\n    </view>\n    \n    <!-- 无数据提示 -->\n    <view v-else-if=\"processedData.length === 0\" class=\"empty-data\">\n      <text>暂无数据</text>\n    </view>\n    \n    <!-- 卡片式视图 -->\n    <view v-else-if=\"displayMode === 'card'\" class=\"score-list\">\n      <!-- 按专业分组展示 -->\n      <view \n        class=\"score-item\" \n        v-for=\"(item, index) in processedData\" \n        :key=\"index\"\n      >\n        <!-- 专业名称 -->\n        <view class=\"major-name\">\n          <view class=\"major-indicator\"></view>\n          <text>{{ item.majorName }}</text>\n        </view>\n        \n        <!-- 分数详情 -->\n        <view class=\"score-details\">\n          <!-- 左侧信息 -->\n          <view class=\"detail-col\">\n            <view class=\"detail-row\">\n              <text class=\"label\">年份：</text>\n              <text class=\"value blue\">{{ item.year }}</text>\n            </view>\n            <view class=\"detail-row\">\n              <text class=\"label\">录取人数：</text>\n              <text class=\"value blue\">{{ item.planNumber || '0' }}</text>\n            </view>\n            <view class=\"detail-row\">\n              <text class=\"label\">最低分：</text>\n              <text class=\"value blue\">{{ item.minScore || '-' }}</text>\n            </view>\n            <view class=\"detail-row\">\n              <text class=\"label\">首选科目：</text>\n              <text class=\"value blue\">{{ item.firstSubject || '物理' }}</text>\n            </view>\n          </view>\n          \n          <!-- 右侧信息 -->\n          <view class=\"detail-col\">\n            <view class=\"detail-row\">\n              <text class=\"label\">省份：</text>\n              <text class=\"value blue\">{{ item.province || '-' }}</text>\n            </view>\n            <view class=\"detail-row\">\n              <text class=\"label\">最高分：</text>\n              <text class=\"value blue\">{{ item.maxScore || item.minScore || '-' }}</text>\n            </view>\n            <view class=\"detail-row\">\n              <text class=\"label\">省控线：</text>\n              <text class=\"value blue\">{{ item.provinceControlLine || '475' }}</text>\n            </view>\n            <view class=\"detail-row\">\n              <text class=\"label\">再选科目：</text>\n              <text class=\"value blue\">{{ item.secondSubject || '化学' }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 表格式视图 -->\n    <view v-else class=\"table-view\">\n      <!-- 顶部筛选与模式 -->\n      <view class=\"table-top-bar\">\n        <view class=\"year-filter\">\n          <uni-icons type=\"calendar\" size=\"20\" color=\"#333\"></uni-icons>\n          <text class=\"year-text\">{{ currentYear }}</text>\n        </view>\n        <view class=\"mode-switch\" @tap=\"toggleDisplayMode\">\n          <uni-icons type=\"grid\" size=\"20\" color=\"#f89d35\"></uni-icons>\n          <text class=\"mode-text\">卡片式</text>\n        </view>\n      </view>\n      \n      <!-- 表格头部 -->\n      <view class=\"table-header\">\n        <view class=\"table-cell\">年份</view>\n        <view class=\"table-cell\">科类</view>\n        <view class=\"table-cell\">省份</view>\n        <view class=\"table-cell\">专业名称</view>\n      </view>\n      \n      <!-- 表格数据行 -->\n      <view v-for=\"(item, index) in tableData\" :key=\"index\" class=\"table-row\">\n        <view class=\"table-cell\">{{ item.year }}</view>\n        <view class=\"table-cell\">{{ item.category || '理科' }}</view>\n        <view class=\"table-cell\">{{ item.province }}</view>\n        <view class=\"table-cell\">{{ item.majorName }}</view>\n      </view>\n    </view>\n    \n    <!-- 年份选择弹窗 - 自定义实现，不依赖uni-popup -->\n    <view class=\"custom-popup\" v-if=\"showYearSelect\" @click.stop=\"closeYearPopup\">\n      <view class=\"popup-mask\"></view>\n      <view class=\"popup-content\" @click.stop>\n        <view class=\"popup-title\">\n          <text>选择年份</text>\n        </view>\n        <view class=\"year-list\">\n          <view \n            v-for=\"year in years\" \n            :key=\"year\"\n            class=\"year-item\" :class=\"{ active: currentYear === year }\"\n            @tap=\"selectYear(year)\"\n          >\n            <text>{{ year }}年</text>\n          </view>\n        </view>\n        <view class=\"popup-cancel-btn\" @tap=\"closeYearPopup\">\n          <text>取消</text>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport admissionApi from '@/api/admission';\nimport request from '@/api/request';\n\nexport default {\n  data() {\n    return {\n      years: [], // 可用年份列表\n      currentYear: null, // 当前选中年份\n      scoreData: {}, // 缓存的分数数据\n      processedData: [], // 处理后的展示数据\n      loading: true, // 加载状态\n      displayMode: 'card', // 显示模式：card-卡片式，table-表格式\n      showYearSelect: false, // 控制年份选择弹窗显示\n      tableData: [], // 表格数据\n      majorMap: {}, // 专业ID到名称的映射\n      loadingText: {\n        contentdown: '加载更多',\n        contentrefresh: '正在加载...',\n        contentnomore: '没有更多数据了'\n      }\n    }\n  },\n  onLoad() {\n    this.initData();\n  },\n  methods: {\n    // 初始化数据\n    async initData() {\n      this.loading = true;\n      try {\n        // 1. 先获取专业列表和映射\n        await this.fetchMajorMap();\n        \n        // 2. 获取年份列表\n        await this.fetchYears();\n        \n        // 3. 如果有年份数据，加载第一个年份的数据\n        if (this.years.length > 0 && this.currentYear) {\n          await this.loadScoreData(this.currentYear);\n        }\n      } catch (err) {\n        console.error('初始化数据失败:', err);\n        uni.showToast({\n          title: '数据加载失败',\n          icon: 'none'\n        });\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    // 获取专业映射\n    async fetchMajorMap() {\n      try {\n        // 获取所有专业信息\n        const res = await request.get('/api/major-info/list');\n        if (res && Array.isArray(res)) {\n          // 创建ID到名称的映射\n          const map = {};\n          res.forEach(major => {\n            map[major.id] = major.name;\n          });\n          this.majorMap = map;\n          console.log('专业映射数据:', map);\n        } else {\n          console.error('获取专业数据格式错误', res);\n        }\n      } catch (err) {\n        console.error('获取专业映射失败:', err);\n        uni.showToast({\n          title: '专业数据加载失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 确保数据源已初始化\n    async ensureDataSource() {\n      // 先检查专业分数表是否有数据\n      try {\n        const scores = await admissionApi.getAllMajorScores();\n        if (!scores || scores.length === 0) {\n          // 如果没有数据，尝试填充历史数据\n          console.log('正在初始化专业分数数据源...');\n          await admissionApi.fillHistoricalScoreData();\n          console.log('专业分数数据源初始化完成');\n        }\n      } catch (err) {\n        console.error('检查数据源失败:', err);\n      }\n    },\n    \n    // 获取年份列表\n    async fetchYears() {\n      try {\n        // 使用API获取招生政策数据，不再需要传入学校ID\n        const res = await admissionApi.getAvailableYears();\n        if (res && res.length > 0) {\n          // 提取所有年份并去重\n          const availableYears = [...new Set(res.map(item => item.year))].sort((a, b) => b - a);\n          if (availableYears.length > 0) {\n            this.years = availableYears;\n            this.currentYear = availableYears[0]; // 默认选中最新的年份\n            return;\n          }\n        }\n        // 如果没有获取到数据，显示提示\n        this.years = [];\n        this.currentYear = null;\n        uni.showToast({\n          title: '暂无年份数据',\n          icon: 'none'\n        });\n      } catch (err) {\n        console.error('获取年份数据失败:', err);\n        this.years = [];\n        this.currentYear = null;\n        uni.showToast({\n          title: '年份数据加载失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 加载指定年份的分数数据\n    async loadScoreData(year) {\n      if (!year) {\n        uni.showToast({\n          title: '请选择年份',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      const cacheKey = `${year}`;\n      if (this.scoreData[cacheKey]) {\n        this.processedData = this.scoreData[cacheKey];\n        this.updateTableData();\n        return; // 如果数据已加载，直接返回\n      }\n      \n      this.loading = true;\n      try {\n        // 使用API获取专业分数线数据，不再需要传入学校ID\n        const res = await admissionApi.getMajorScores(year);\n        console.log('API返回的原始数据:', JSON.stringify(res));\n        \n        // 检查返回的数据格式并进行处理\n        if (res && Array.isArray(res)) {\n          // 添加专业名称信息\n          const processedData = res.map(item => {\n            // 添加专业名称\n            return {\n              ...item,\n              majorName: this.getMajorNameById(item.majorId)\n            };\n          });\n          \n          console.log('处理后的前端显示数据:', JSON.stringify(processedData));\n          this.scoreData[cacheKey] = processedData;\n          this.processedData = processedData;\n          \n          // 更新表格数据\n          this.updateTableData();\n        } else {\n          console.error('API返回的数据格式不是数组', res);\n          this.processedData = [];\n          this.tableData = [];\n          uni.showToast({\n            title: '暂无分数数据',\n            icon: 'none'\n          });\n        }\n      } catch (err) {\n        console.error('获取分数数据失败:', err);\n        this.processedData = [];\n        this.tableData = [];\n        uni.showToast({\n          title: '分数数据加载失败',\n          icon: 'none'\n        });\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    // 更新表格数据\n    updateTableData() {\n      this.tableData = this.processedData.map(item => ({\n        year: item.year,\n        category: item.firstSubject === '物理' ? '理科' : '文科',\n        province: item.province,\n        majorName: item.majorName\n      }));\n    },\n    \n    // 切换显示模式\n    toggleDisplayMode() {\n      this.displayMode = this.displayMode === 'card' ? 'table' : 'card';\n    },\n    \n    // 打开年份选择弹窗\n    openYearPopup() {\n      this.showYearSelect = true;\n    },\n    \n    // 关闭年份选择弹窗\n    closeYearPopup() {\n      console.log('关闭年份选择弹窗');\n      this.showYearSelect = false;\n    },\n    \n    // 选择年份\n    selectYear(year) {\n      if (this.currentYear === year) {\n        this.closeYearPopup();\n        return;\n      }\n      \n      this.currentYear = year;\n      this.loadScoreData(year);\n      this.closeYearPopup();\n    },\n    \n    // 根据ID获取专业名称\n    getMajorNameById(majorId) {\n      // 使用从数据库获取的映射\n      return this.majorMap[majorId] || `专业ID:${majorId}`;\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding-bottom: 40rpx;\n}\n\n// 添加指引提示样式\n.guide-tips {\n  text-align: center;\n  padding: 80rpx 30rpx;\n  color: #999;\n  font-size: 28rpx;\n}\n\n.header {\n  background: #3399cc;\n  padding: 30rpx;\n  color: white;\n  text-align: center;\n  \n  .title {\n    font-size: 36rpx;\n    font-weight: bold;\n  }\n}\n\n.filter-bar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 30rpx;\n  background: #fff;\n  margin-bottom: 20rpx;\n  \n  .year-selector, .display-mode {\n    display: flex;\n    align-items: center;\n    gap: 10rpx;\n  }\n  \n  .year-text, .mode-text {\n    font-size: 30rpx;\n  }\n}\n\n.score-list {\n  padding: 0 20rpx;\n}\n\n.score-item {\n  background: #fff;\n  border-radius: 12rpx;\n  margin-bottom: 20rpx;\n  overflow: hidden;\n  \n  .major-name {\n    display: flex;\n    align-items: center;\n    padding: 20rpx;\n    font-size: 32rpx;\n    font-weight: bold;\n    color: #333;\n    \n    .major-indicator {\n      width: 8rpx;\n      height: 36rpx;\n      background: #4a7bff;\n      margin-right: 20rpx;\n      border-radius: 4rpx;\n    }\n  }\n  \n  .score-details {\n    display: flex;\n    padding: 0 20rpx 20rpx;\n    \n    .detail-col {\n      flex: 1;\n    }\n    \n    .detail-row {\n      margin: 16rpx 0;\n      \n      .label {\n        font-size: 28rpx;\n        color: #666;\n      }\n      \n      .value {\n        font-size: 28rpx;\n        \n        &.blue {\n          color: #4a7bff;\n        }\n      }\n    }\n  }\n}\n\n/* 表格式视图样式 */\n.table-view {\n  background: #fff;\n  border-radius: 0;\n  overflow: hidden;\n  margin-bottom: 20rpx;\n  \n  .table-top-bar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20rpx 30rpx;\n    background: #fff;\n    border-bottom: 2rpx solid #f1f1f1;\n    \n    .year-filter {\n      display: flex;\n      align-items: center;\n      gap: 10rpx;\n    }\n    \n    .year-text {\n      font-size: 30rpx;\n      font-weight: bold;\n    }\n    \n    .mode-switch {\n      display: flex;\n      align-items: center;\n      gap: 8rpx;\n      color: #f89d35;\n    }\n    \n    .mode-text {\n      font-size: 28rpx;\n    }\n  }\n  \n  .table-header {\n    display: flex;\n    background: #f8f8f8;\n    font-size: 28rpx;\n    color: #666;\n    padding: 25rpx 0;\n    font-weight: normal;\n    border-bottom: 2rpx solid #eee;\n  }\n  \n  .table-row {\n    display: flex;\n    font-size: 28rpx;\n    color: #333;\n    border-bottom: 2rpx solid #f5f5f5;\n    \n    &:last-child {\n      border-bottom: none;\n    }\n  }\n  \n  .table-cell {\n    flex: 1;\n    padding: 25rpx 10rpx;\n    text-align: center;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    word-break: break-all;\n    line-height: 1.4;\n  }\n}\n\n.loading, .empty-data {\n  height: 300rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #666;\n  font-size: 28rpx;\n}\n\n/* 自定义弹窗样式 */\n.custom-popup {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 999;\n  \n  .popup-mask {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n  \n  .popup-content {\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #fff;\n    border-radius: 20rpx 20rpx 0 0;\n    transform: translateY(0);\n    transition: transform 0.3s ease;\n    \n    .popup-title {\n      padding: 30rpx;\n      text-align: center;\n      font-size: 32rpx;\n      font-weight: bold;\n      border-bottom: 1rpx solid #f0f0f0;\n    }\n    \n    .year-list {\n      display: flex;\n      flex-wrap: wrap;\n      padding: 20rpx;\n      \n      .year-item {\n        width: 25%;\n        padding: 20rpx 0;\n        text-align: center;\n        font-size: 28rpx;\n        \n        &.active {\n          color: #4a7bff;\n          font-weight: bold;\n        }\n      }\n    }\n    \n    .popup-cancel-btn {\n      padding: 30rpx;\n      text-align: center;\n      font-size: 32rpx;\n      color: #333;\n      border-top: 1rpx solid #f0f0f0;\n      background-color: #fff;\n      font-weight: 500;\n      \n      &:active {\n        background-color: #f5f5f5;\n      }\n    }\n  }\n}\n</style> ","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./score.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./score.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1742829222082\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}